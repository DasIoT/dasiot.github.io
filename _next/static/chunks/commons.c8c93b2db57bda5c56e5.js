(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[0],{"7W2i":function(t,e,n){var r=n("SksO");t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},FYa8:function(t,e,n){"use strict";var r;e.__esModule=!0,e.HeadManagerContext=void 0;var o=((r=n("q1tI"))&&r.__esModule?r:{default:r}).default.createContext({});e.HeadManagerContext=o},McF2:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("jWoc"),o=n("hEnr"),s=n("zcj1");const a={},i=new r.a,c=new class{constructor(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}get length(){return this._length}shift(){if(this._index>=this._headLength){const t=this._head;if(t.length=0,this._head=this._tail,this._tail=t,this._index=0,this._headLength=this._head.length,!this._headLength)return}const t=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,t}push(t){return this._length++,this._tail.push(t),this}unshift(t){return this._head[--this._index]=t,this._length++,this}},l={sceneId:null,time:null,startTime:null,prevTime:null,deltaTime:null},u=[];let h,d=0,f=0;const p=new function(){this.version="1.0.0",this.scenes={},this._superTypes={},this._addScene=function(t){if(t.id){if(p.scenes[t.id])return void console.error(`[ERROR] Scene ${s.a.inQuotes(t.id)} already exists`)}else t.id=i.addItem({});p.scenes[t.id]=t;const e=t.ticksPerOcclusionTest,n=t.ticksPerRender;a[t.id]={ticksPerOcclusionTest:e,ticksPerRender:n,renderCountdown:n},o.a.components.scenes++,t.once("destroyed",(()=>{i.removeItem(t.id),delete p.scenes[t.id],delete a[t.id],o.a.components.scenes--}))},this.clear=function(){let t;for(const e in p.scenes)p.scenes.hasOwnProperty(e)&&(t=p.scenes[e],"default.scene"===e?t.clear():(t.destroy(),delete p.scenes[t.id]))},this.scheduleTask=function(t,e){c.push(t),c.push(e)},this.runTasks=function(t=-1){let e,n,r=(new Date).getTime(),o=0;for(;c.length>0&&(t<0||r<t);)e=c.shift(),n=c.shift(),n?e.call(n):e(),r=(new Date).getTime(),o++;return o},this.getNumTasks=function(){return c.length}},m=function(){let t=Date.now();if(d>0){h=t-d;var e=1e3/h;f+=e,u.push(e),u.length>=30&&(f-=u.shift()),o.a.frame.fps=Math.round(f/u.length)}!function(t){const e=p.runTasks(t+10),n=p.getNumTasks();o.a.frame.tasksRun=e,o.a.frame.tasksScheduled=n,o.a.frame.tasksBudget=10}(t),function(t){for(var e in l.time=t,p.scenes)if(p.scenes.hasOwnProperty(e)){var n=p.scenes[e];l.sceneId=e,l.startTime=n.startTime,l.deltaTime=null!=l.prevTime?l.time-l.prevTime:0,n.fire("tick",l,!0)}l.prevTime=t}(t),function(){const t=p.scenes,e=!1;let n,r,o,s,i;for(i in t)t.hasOwnProperty(i)&&(n=t[i],r=a[i],r||(r=a[i]={}),o=n.ticksPerOcclusionTest,r.ticksPerOcclusionTest!==o&&(r.ticksPerOcclusionTest=o,r.renderCountdown=o),--n.occlusionTestCountdown<=0&&(n.doOcclusionTest(),n.occlusionTestCountdown=o),s=n.ticksPerRender,r.ticksPerRender!==s&&(r.ticksPerRender=s,r.renderCountdown=s),0===--r.renderCountdown&&(n.render(e),r.renderCountdown=s))}(),d=t,window.requestAnimationFrame(m)};window.requestAnimationFrame(m)},Nsbk:function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},PJYZ:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},Qetd:function(t,e,n){"use strict";var r=Object.assign.bind(Object);t.exports=r,t.exports.default=t.exports},SksO:function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},TqRt:function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},W8MJ:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},WTvf:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("tehY"),o=function(){const t=[],e=[],n=[],o=[],s=[];let a=0;const i=new Uint16Array(3),c=new Uint16Array(3),l=new Uint16Array(3),u=r.a.vec3(),h=r.a.vec3(),d=r.a.vec3(),f=r.a.vec3(),p=r.a.vec3(),m=r.a.vec3(),g=r.a.vec3();return function(y,M,_,v){!function(r,s){const a={};let i,c,l,u;const h=Math.pow(10,4);let d,f,p=0;for(d=0,f=r.length;d<f;d+=3)i=r[d],c=r[d+1],l=r[d+2],u=Math.round(i*h)+"_"+Math.round(c*h)+"_"+Math.round(l*h),void 0===a[u]&&(a[u]=p/3,t[p++]=i,t[p++]=c,t[p++]=l),e[d/3]=a[u];for(d=0,f=s.length;d<f;d++)o[d]=e[s[d]],n[o[d]]=s[d]}(y,M),function(e,n){a=0;for(let y=0,M=e;y<M;y+=3){const e=3*o[y],M=3*o[y+1],_=3*o[y+2];n?(i[0]=t[e],i[1]=t[e+1],i[2]=t[e+2],c[0]=t[M],c[1]=t[M+1],c[2]=t[M+2],l[0]=t[_],l[1]=t[_+1],l[2]=t[_+2],r.a.decompressPosition(i,n,u),r.a.decompressPosition(c,n,h),r.a.decompressPosition(l,n,d)):(u[0]=t[e],u[1]=t[e+1],u[2]=t[e+2],h[0]=t[M],h[1]=t[M+1],h[2]=t[M+2],d[0]=t[_],d[1]=t[_+1],d[2]=t[_+2]),r.a.subVec3(d,h,f),r.a.subVec3(u,h,p),r.a.cross3Vec3(f,p,m),r.a.normalizeVec3(m,g);const v=s[a]||(s[a]={normal:r.a.vec3()});v.normal[0]=g[0],v.normal[1]=g[1],v.normal[2]=g[2],a++}}(M.length,_);const A=[],w=Math.cos(r.a.DEGTORAD*v),b={};let E,S,T,V,O,B,I,N,F,x,L,P=!1;for(let t=0,e=M.length;t<e;t+=3){const e=t/3;for(let n=0;n<3;n++)E=o[t+n],S=o[t+(n+1)%3],T=Math.min(E,S),V=Math.max(E,S),O=T+","+V,void 0===b[O]?b[O]={index1:T,index2:V,face1:e,face2:void 0}:b[O].face2=e}for(O in b)B=b[O],void 0!==B.face2&&(I=s[B.face1].normal,N=s[B.face2].normal,F=r.a.dotVec3(I,N),F>w)||(x=n[B.index1],L=n[B.index2],(!P&&x>65535||L>65535)&&(P=!0),A.push(x),A.push(L));return P?new Uint32Array(A):new Uint16Array(A)}}()},WkPL:function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},ZhPi:function(t,e,n){var r=n("WkPL");t.exports=function(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},a1gu:function(t,e,n){var r=n("cDf5"),o=n("PJYZ");t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!==typeof e?o(t):e}},bFGi:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={WEBGL:!1,SUPPORTED_EXTENSIONS:{}},o=document.createElement("canvas");if(o){const t=o.getContext("webgl",{antialias:!0})||o.getContext("experimental-webgl",{antialias:!0});r.WEBGL=!!t,r.WEBGL&&(r.ANTIALIAS=t.getContextAttributes().antialias,t.getShaderPrecisionFormat?t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0?r.FS_MAX_FLOAT_PRECISION="highp":t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?r.FS_MAX_FLOAT_PRECISION="mediump":r.FS_MAX_FLOAT_PRECISION="lowp":r.FS_MAX_FLOAT_PRECISION="mediump",r.DEPTH_BUFFER_BITS=t.getParameter(t.DEPTH_BITS),r.MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE),r.MAX_CUBE_MAP_SIZE=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),r.MAX_RENDERBUFFER_SIZE=t.getParameter(t.MAX_RENDERBUFFER_SIZE),r.MAX_TEXTURE_UNITS=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),r.MAX_TEXTURE_IMAGE_UNITS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r.MAX_VERTEX_ATTRIBS=t.getParameter(t.MAX_VERTEX_ATTRIBS),r.MAX_VERTEX_UNIFORM_VECTORS=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),r.MAX_FRAGMENT_UNIFORM_VECTORS=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),r.MAX_VARYING_VECTORS=t.getParameter(t.MAX_VARYING_VECTORS),t.getSupportedExtensions().forEach((function(t){r.SUPPORTED_EXTENSIONS[t]=!0})),r.depthTexturesSupported=r.SUPPORTED_EXTENSIONS.WEBGL_depth_texture)}},cDf5:function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},f7Wv:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t,e,n,r,o,s,a,i,c){switch(this._gl=t,this.type=e,this.allocated=!1,n.constructor){case Uint8Array:this.itemType=t.UNSIGNED_BYTE,this.itemByteSize=1;break;case Int8Array:this.itemType=t.BYTE,this.itemByteSize=1;break;case Uint16Array:this.itemType=t.UNSIGNED_SHORT,this.itemByteSize=2;break;case Int16Array:this.itemType=t.SHORT,this.itemByteSize=2;break;case Uint32Array:this.itemType=t.UNSIGNED_INT,this.itemByteSize=4;break;case Int32Array:this.itemType=t.INT,this.itemByteSize=4;break;default:this.itemType=t.FLOAT,this.itemByteSize=4}this.usage=s,this.length=0,this.dataLength=r,this.numItems=0,this.itemSize=o,this.normalized=!!a,this.stride=i||0,this.offset=c||0,this._allocate(n)}_allocate(t){if(this.allocated=!1,this._handle=this._gl.createBuffer(),!this._handle)throw"Failed to allocate WebGL ArrayBuffer";this._handle&&(this._gl.bindBuffer(this.type,this._handle),this._gl.bufferData(this.type,t.length>this.dataLength?t.slice(0,this.dataLength):t,this.usage),this._gl.bindBuffer(this.type,null),this.length=t.length,this.numItems=this.length/this.itemSize,this.allocated=!0)}setData(t,e){this.allocated&&(t.length+(e||0)>this.length?(this.destroy(),this._allocate(t)):(this._gl.bindBuffer(this.type,this._handle),e||0===e?this._gl.bufferSubData(this.type,e*this.itemByteSize,t):this._gl.bufferData(this.type,t,this.usage),this._gl.bindBuffer(this.type,null)))}bind(){this.allocated&&this._gl.bindBuffer(this.type,this._handle)}unbind(){this.allocated&&this._gl.bindBuffer(this.type,null)}destroy(){this.allocated&&(this._gl.deleteBuffer(this._handle),this._handle=null,this.allocated=!1)}}},hEnr:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={build:{version:"0.8"},client:{browser:navigator&&navigator.userAgent?navigator.userAgent:"n/a"},components:{scenes:0,models:0,meshes:0,objects:0},memory:{meshes:0,positions:0,colors:0,normals:0,uvs:0,indices:0,textures:0,transforms:0,materials:0,programs:0},frame:{frameCount:0,fps:0,useProgram:0,bindTexture:0,bindArray:0,drawElements:0,drawArrays:0,tasksRun:0,tasksScheduled:0}}},jSXj:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("tehY");function o(t,e,n,r){let o=t[e]/(Math.abs(t[e])+Math.abs(t[e+1])+Math.abs(t[e+2])),s=t[e+1]/(Math.abs(t[e])+Math.abs(t[e+1])+Math.abs(t[e+2]));if(t[e+2]<0){let t=(1-Math.abs(s))*(o>=0?1:-1),e=(1-Math.abs(o))*(s>=0?1:-1);o=t,s=e}return new Int8Array([Math[n](127.5*o+(o<0?-1:0)),Math[r](127.5*s+(s<0?-1:0))])}function s(t){let e=t[0],n=t[1];e/=e<0?127:128,n/=n<0?127:128;const r=1-Math.abs(e)-Math.abs(n);r<0&&(e=(1-Math.abs(n))*(e>=0?1:-1),n=(1-Math.abs(e))*(n>=0?1:-1));const o=Math.sqrt(e*e+n*n+r*r);return[e/o,n/o,r/o]}function a(t,e,n){return t[e]*n[0]+t[e+1]*n[1]+t[e+2]*n[2]}const i={getPositionsBounds:function(t){const e=new Float32Array(3),n=new Float32Array(3);let r,o;for(r=0;r<3;r++)e[r]=Number.MAX_VALUE,n[r]=-Number.MAX_VALUE;for(r=0;r<t.length;r+=3)for(o=0;o<3;o++)e[o]=Math.min(e[o],t[r+o]),n[o]=Math.max(n[o],t[r+o]);return{min:e,max:n}},createPositionsDecodeMatrix:function(){const t=r.a.mat4(),e=r.a.mat4();return function(n,o){o=o||r.a.mat4();const s=n[0],a=n[1],i=n[2],c=n[3]-s,l=n[4]-a,u=n[5]-i,h=65535;return r.a.identityMat4(t),r.a.translationMat4v(n,t),r.a.identityMat4(e),r.a.scalingMat4v([c/h,l/h,u/h],e),r.a.mulMat4(t,e,o),o}}(),compressPositions:function(){const t=r.a.mat4(),e=r.a.mat4();return function(n,o,s){const a=new Uint16Array(n.length);var i=new Float32Array([s[0]!==o[0]?65535/(s[0]-o[0]):0,s[1]!==o[1]?65535/(s[1]-o[1]):0,s[2]!==o[2]?65535/(s[2]-o[2]):0]);let c;for(c=0;c<n.length;c+=3)a[c+0]=Math.floor((n[c+0]-o[0])*i[0]),a[c+1]=Math.floor((n[c+1]-o[1])*i[1]),a[c+2]=Math.floor((n[c+2]-o[2])*i[2]);r.a.identityMat4(t),r.a.translationMat4v(o,t),r.a.identityMat4(e),r.a.scalingMat4v([(s[0]-o[0])/65535,(s[1]-o[1])/65535,(s[2]-o[2])/65535],e);return{quantized:a,decodeMatrix:r.a.mulMat4(t,e,r.a.identityMat4())}}}(),decompressPositions:function(t,e,n=new Float32Array(t.length)){for(let r=0,o=t.length;r<o;r+=3)n[r+0]=t[r+0]*e[0]+e[12],n[r+1]=t[r+1]*e[5]+e[13],n[r+2]=t[r+2]*e[10]+e[14];return n},decompressPosition:function(t,e,n){return n[0]=t[0]*e[0]+e[12],n[1]=t[1]*e[5]+e[13],n[2]=t[2]*e[10]+e[14],n},decompressAABB:function(t,e,n=t){return n[0]=t[0]*e[0]+e[12],n[1]=t[1]*e[5]+e[13],n[2]=t[2]*e[10]+e[14],n[3]=t[3]*e[0]+e[12],n[4]=t[4]*e[5]+e[13],n[5]=t[5]*e[10]+e[14],n},getUVBounds:function(t){const e=new Float32Array(2),n=new Float32Array(2);let r,o;for(r=0;r<2;r++)e[r]=Number.MAX_VALUE,n[r]=-Number.MAX_VALUE;for(r=0;r<t.length;r+=2)for(o=0;o<2;o++)e[o]=Math.min(e[o],t[r+o]),n[o]=Math.max(n[o],t[r+o]);return{min:e,max:n}},compressUVs:function(){const t=r.a.mat3(),e=r.a.mat3();return function(n,o,s){const a=new Uint16Array(n.length),i=new Float32Array([65535/(s[0]-o[0]),65535/(s[1]-o[1])]);let c;for(c=0;c<n.length;c+=2)a[c+0]=Math.floor((n[c+0]-o[0])*i[0]),a[c+1]=Math.floor((n[c+1]-o[1])*i[1]);r.a.identityMat3(t),r.a.translationMat3v(o,t),r.a.identityMat3(e),r.a.scalingMat3v([(s[0]-o[0])/65535,(s[1]-o[1])/65535],e);return{quantized:a,decodeMatrix:r.a.mulMat3(t,e,r.a.identityMat3())}}}(),decompressUVs:function(t,e,n=new Float32Array(t.length)){for(let r=0,o=t.length;r<o;r+=3)n[r+0]=t[r+0]*e[0]+e[6],n[r+1]=t[r+1]*e[4]+e[7];return n},decompressUV:function(t,e,n){n[0]=t[0]*e[0]+e[6],n[1]=t[1]*e[4]+e[7]},compressNormals:function(t){const e=new Int8Array(t.length);let n,r,i,c,l;for(let u=0;u<t.length;u+=3)i=n=o(t,u,"floor","floor"),r=s(n),c=l=a(t,u,r),n=o(t,u,"ceil","floor"),r=s(n),c=a(t,u,r),c>l&&(i=n,l=c),n=o(t,u,"floor","ceil"),r=s(n),c=a(t,u,r),c>l&&(i=n,l=c),n=o(t,u,"ceil","ceil"),r=s(n),c=a(t,u,r),c>l&&(i=n,l=c),e[u]=i[0],e[u+1]=i[1];return e},decompressNormals:function(t,e){for(let n=0,r=0,o=t.length;n<o;n+=2){let o=t[n+0],s=t[n+1];o=(2*o+1)/255,s=(2*s+1)/255;const a=1-Math.abs(o)-Math.abs(s);a<0&&(o=(1-Math.abs(s))*(o>=0?1:-1),s=(1-Math.abs(o))*(s>=0?1:-1));const i=Math.sqrt(o*o+s*s+a*a);e[r+0]=o/i,e[r+1]=s/i,e[r+2]=a/i,r+=3}return e},decompressNormal:function(t,e){let n=t[0],r=t[1];n=(2*n+1)/255,r=(2*r+1)/255;const o=1-Math.abs(n)-Math.abs(r);o<0&&(n=(1-Math.abs(r))*(n>=0?1:-1),r=(1-Math.abs(n))*(r>=0?1:-1));const s=Math.sqrt(n*n+r*r+o*o);return e[0]=n/s,e[1]=r/s,e[2]=o/s,e}}},jWoc:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t,e){this.items=t||[],this._lastUniqueId=(e||0)+1}addItem(){let t;if(2===arguments.length){const e=arguments[0];if(t=arguments[1],this.items[e])throw"ID clash: '"+e+"'";return this.items[e]=t,e}for(t=arguments[0]||{};;){const e=this._lastUniqueId++;if(!this.items[e])return this.items[e]=t,e}}removeItem(t){const e=this.items[t];return delete this.items[t],e}}},ls82:function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",i=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(N){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,s=Object.create(o.prototype),a=new O(r||[]);return s._invoke=function(t,e,n){var r=h;return function(o,s){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw s;return I()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var i=S(a,n);if(i){if(i===m)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=u(t,e,n);if("normal"===c.type){if(r=n.done?p:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(t,n,a),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(N){return{type:"throw",arg:N}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",m={};function g(){}function y(){}function M(){}var _={};_[s]=function(){return this};var v=Object.getPrototypeOf,A=v&&v(v(B([])));A&&A!==n&&r.call(A,s)&&(_=A);var w=M.prototype=g.prototype=Object.create(_);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,s,a,i){var c=u(t[o],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"===typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,i)}),(function(t){n("throw",t,a,i)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,i)}))}i(c.arg)}var o;this._invoke=function(t,r){function s(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(s,s):s()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=u(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function V(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function B(t){if(t){var n=t[s];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:I}}function I(){return{value:e,done:!0}}return y.prototype=w.constructor=M,M.constructor=y,y.displayName=c(M,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,c(t,i,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},b(E.prototype),E.prototype[a]=function(){return this},t.AsyncIterator=E,t.async=function(e,n,r,o,s){void 0===s&&(s=Promise);var a=new E(l(e,n,r,o),s);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(w),c(w,i,"Generator"),w[s]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=B,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(V),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return i.type="throw",i.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],i=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var s=o;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),V(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;V(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:B(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}},lwsE:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},mrKj:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("jWoc");class o{constructor(t,e,n){if(this.allocated=!1,this.compiled=!1,this.handle=t.createShader(e),this.handle){if(this.allocated=!0,t.shaderSource(this.handle,n),t.compileShader(this.handle),this.compiled=t.getShaderParameter(this.handle,t.COMPILE_STATUS),!this.compiled&&!t.isContextLost()){const e=n.split("\n"),r=[];for(let t=0;t<e.length;t++)r.push(t+1+": "+e[t]+"\n");this.errors=[],this.errors.push(""),this.errors.push(t.getShaderInfoLog(this.handle)),this.errors=this.errors.concat(r.join(""))}}else this.errors=["Failed to allocate"]}destroy(){}}class s{constructor(t,e){this.bindTexture=function(n,r){return!!n.bind(r)&&(t.uniform1i(e,r),!0)}}}class a{constructor(t,e){this._gl=t,this.location=e}bindArrayBuffer(t){t&&(t.bind(),this._gl.enableVertexAttribArray(this.location),this._gl.vertexAttribPointer(this.location,t.itemSize,t.itemType,t.normalized,t.stride,t.offset))}}const i=new r.a({});function c(t){const e=[];let n,r;for(let o=0,s=t.length;o<s;o++)n=t[o],r=n.indexOf("/"),r>0&&"/"===n.charAt(r+1)&&(n=n.substring(0,r)),e.push(n);return e.join("\n")}function l(t){console.error(t.join("\n"))}class u{constructor(t,e){this.id=i.addItem({}),this.source=e,this.init(t)}init(t){if(this.gl=t,this.allocated=!1,this.compiled=!1,this.linked=!1,this.validated=!1,this.errors=null,this.uniforms={},this.samplers={},this.attributes={},this._vertexShader=new o(t,t.VERTEX_SHADER,c(this.source.vertex)),this._fragmentShader=new o(t,t.FRAGMENT_SHADER,c(this.source.fragment)),!this._vertexShader.allocated)return this.errors=["Vertex shader failed to allocate"].concat(this._vertexShader.errors),void l(this.errors);if(!this._fragmentShader.allocated)return this.errors=["Fragment shader failed to allocate"].concat(this._fragmentShader.errors),void l(this.errors);if(this.allocated=!0,!this._vertexShader.compiled)return this.errors=["Vertex shader failed to compile"].concat(this._vertexShader.errors),void l(this.errors);if(!this._fragmentShader.compiled)return this.errors=["Fragment shader failed to compile"].concat(this._fragmentShader.errors),void l(this.errors);let e,n,r,i,u;if(this.compiled=!0,this.handle=t.createProgram(),!this.handle)return void(this.errors=["Failed to allocate program"]);if(t.attachShader(this.handle,this._vertexShader.handle),t.attachShader(this.handle,this._fragmentShader.handle),t.linkProgram(this.handle),this.linked=t.getProgramParameter(this.handle,t.LINK_STATUS),this.validated=!0,!this.linked||!this.validated)return this.errors=[],this.errors.push(""),this.errors.push(t.getProgramInfoLog(this.handle)),this.errors.push("\nVertex shader:\n"),this.errors=this.errors.concat(this.source.vertex),this.errors.push("\nFragment shader:\n"),this.errors=this.errors.concat(this.source.fragment),void l(this.errors);const h=t.getProgramParameter(this.handle,t.ACTIVE_UNIFORMS);for(n=0;n<h;++n)r=t.getActiveUniform(this.handle,n),r&&(i=r.name,"\0"===i[i.length-1]&&(i=i.substr(0,i.length-1)),u=t.getUniformLocation(this.handle,i),r.type===t.SAMPLER_2D||r.type===t.SAMPLER_CUBE||35682===r.type?this.samplers[i]=new s(t,u):this.uniforms[i]=u);const d=t.getProgramParameter(this.handle,t.ACTIVE_ATTRIBUTES);for(n=0;n<d;n++)e=t.getActiveAttrib(this.handle,n),e&&(u=t.getAttribLocation(this.handle,e.name),this.attributes[e.name]=new a(t,u));this.allocated=!0}bind(){this.allocated&&this.gl.useProgram(this.handle)}getLocation(t){if(this.allocated)return this.uniforms[t]}getAttribute(t){if(this.allocated)return this.attributes[t]}bindTexture(t,e,n){if(!this.allocated)return!1;const r=this.samplers[t];return!!r&&r.bindTexture(e,n)}destroy(){this.allocated&&(i.removeItem(this.id),this.gl.deleteProgram(this.handle),this.gl.deleteShader(this._vertexShader.handle),this.gl.deleteShader(this._fragmentShader.handle),this.handle=null,this.attributes=null,this.uniforms=null,this.samplers=null,this.allocated=!1)}}},nJY8:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t,e,n){this.id=n&&n.id?n.id:t,this.viewer=e,this._eventSubs={},e.addPlugin(this)}on(t,e){let n=this._eventSubs[t];n||(n=[],this._eventSubs[t]=n),n.push(e)}fire(t,e){const n=this._eventSubs[t];if(n)for(let r=0,o=n.length;r<o;r++)n[r](e)}log(t){console.log(`[xeokit plugin ${this.id}]: ${t}`)}warn(t){console.warn(`[xeokit plugin ${this.id}]: ${t}`)}error(t){console.error(`[xeokit plugin ${this.id}]: ${t}`)}send(t,e){}destroy(){this.viewer.removePlugin(this)}}},o0o1:function(t,e,n){t.exports=n("ls82")},oDdi:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("McF2"),o=n("zcj1"),s=n("jWoc");class a{get type(){return"Component"}get isComponent(){return!0}constructor(t=null,e={}){if(this.scene=null,"Scene"===this.type)this.scene=this,this.viewer=e.viewer;else{if("Scene"===t.type)this.scene=t;else{if(!(t instanceof a))throw"Invalid param: owner must be a Component";this.scene=t.scene}this._owner=t,this._renderer=this.scene._renderer}this._dontClear=!!e.dontClear,this._renderer=this.scene._renderer,this.meta=e.meta||{},this.id=e.id,this.destroyed=!1,this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._eventSubsNum=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this!==this.scene&&this.scene._addComponent(this),this._updateScheduled=!1,t&&t._own(this)}glRedraw(){this._renderer.imageDirty(),this.castsShadow&&this._renderer.shadowsDirty()}glResort(){this._renderer.needStateSort()}get owner(){return this._owner}isType(t){return this.type===t}fire(t,e,n){this._events||(this._events={}),this._eventSubs||(this._eventSubs={},this._eventSubsNum={}),!0!==n&&(this._events[t]=e||!0);const r=this._eventSubs[t];let o;if(r)for(const s in r)r.hasOwnProperty(s)&&(o=r[s],this._eventCallDepth++,this._eventCallDepth<300?o.callback.call(o.scope,e):this.error("fire: potential stack overflow from recursive event '"+t+"' - dropping this event"),this._eventCallDepth--)}on(t,e,n){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new s.a),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={}),this._eventSubsNum||(this._eventSubsNum={});let r=this._eventSubs[t];r?this._eventSubsNum[t]++:(r={},this._eventSubs[t]=r,this._eventSubsNum[t]=1);const o=this._subIdMap.addItem();r[o]={callback:e,scope:n||this},this._subIdEvents[o]=t;const a=this._events[t];return void 0!==a&&e.call(n||this,a),o}off(t){if(void 0===t||null===t)return;if(!this._subIdEvents)return;const e=this._subIdEvents[t];if(e){delete this._subIdEvents[t];const n=this._eventSubs[e];n&&(delete n[t],this._eventSubsNum[e]--),this._subIdMap.removeItem(t)}}once(t,e,n){const r=this,o=this.on(t,(function(t){r.off(o),e.call(n||this,t)}),n)}hasSubs(t){return this._eventSubsNum&&this._eventSubsNum[t]>0}log(t){t="[LOG]"+this._message(t),window.console.log(t),this.scene.fire("log",t)}_message(t){return" ["+this.type+" "+o.a.inQuotes(this.id)+"]: "+t}warn(t){t="[WARN]"+this._message(t),window.console.warn(t),this.scene.fire("warn",t)}error(t){t="[ERROR]"+this._message(t),window.console.error(t),this.scene.fire("error",t)}_attach(t){const e=t.name;if(!e)return void this.error("Component 'name' expected");let n=t.component;const r=t.sceneDefault,s=t.sceneSingleton,a=t.type,i=t.on,c=!1!==t.recompiles;if(n&&(o.a.isNumeric(n)||o.a.isString(n))){const t=n;if(n=this.scene.components[t],!n)return void this.error("Component not found: "+o.a.inQuotes(t))}if(!n)if(!0===s){const t=this.scene.types[a];for(const e in t)if(t.hasOwnProperty){n=t[e];break}if(!n)return this.error("Scene has no default component for '"+e+"'"),null}else if(!0===r&&(n=this.scene[e],!n))return this.error("Scene has no default component for '"+e+"'"),null;if(n){if(n.scene.id!==this.scene.id)return void this.error("Not in same scene: "+n.type+" "+o.a.inQuotes(n.id));if(a&&!n.isType(a))return void this.error("Expected a "+a+" type or subtype: "+n.type+" "+o.a.inQuotes(n.id))}this._attachments||(this._attachments={});const l=this._attached[e];let u,h,d;if(l){if(n&&l.id===n.id)return;const t=this._attachments[l.id];for(u=t.subs,h=0,d=u.length;h<d;h++)l.off(u[h]);delete this._attached[e],delete this._attachments[l.id];const r=t.params.onDetached;r&&(o.a.isFunction(r)?r(l):r.scope?r.callback.call(r.scope,l):r.callback(l)),t.managingLifecycle&&l.destroy()}if(n){const r={params:t,component:n,subs:[],managingLifecycle:false};r.subs.push(n.once("destroyed",(function(){r.params.component=null,this._attach(r.params)}),this)),c&&r.subs.push(n.on("dirty",(function(){this.fire("dirty",this)}),this)),this._attached[e]=n,this._attachments[n.id]=r;const s=t.onAttached;if(s&&(o.a.isFunction(s)?s(n):s.scope?s.callback.call(s.scope,n):s.callback(n)),i){let t,e,s,a;for(t in i)if(i.hasOwnProperty(t)){if(e=i[t],o.a.isFunction(e)?(s=e,a=null):(s=e.callback,a=e.scope),!s)continue;r.subs.push(n.on(t,s,a))}}}return c&&this.fire("dirty",this),this.fire(e,n),n}_checkComponent(t,e){if(!e.isComponent){if(!o.a.isID(e))return void this.error("Expected a Component or ID");{const t=e;if(!(e=this.scene.components[t]))return void this.error("Component not found: "+t)}}if(t===e.type){if(e.scene.id===this.scene.id)return e;this.error("Not in same scene: "+e.type)}else this.error("Expected a "+t+" Component")}_checkComponent2(t,e){if(!e.isComponent){if(!o.a.isID(e))return void this.error("Expected a Component or ID");{const t=e;if(!(e=this.scene.components[t]))return void this.error("Component not found: "+t)}}if(e.scene.id===this.scene.id){for(var n=0,r=t.length;n<r;n++)if(t[n]===e.type)return e;return this.error("Expected component types: "+t),null}this.error("Not in same scene: "+e.type)}_own(t){this._ownedComponents||(this._ownedComponents={}),this._ownedComponents[t.id]||(this._ownedComponents[t.id]=t),t.once("destroyed",(()=>{delete this._ownedComponents[t.id]}),this)}_needUpdate(t){this._updateScheduled||(this._updateScheduled=!0,0===t?this._doUpdate():r.a.scheduleTask(this._doUpdate,this))}_doUpdate(){this._updateScheduled&&(this._updateScheduled=!1,this._update&&this._update())}_update(){}clear(){if(this._ownedComponents)for(var t in this._ownedComponents)if(this._ownedComponents.hasOwnProperty(t)){this._ownedComponents[t].destroy(),delete this._ownedComponents[t]}}destroy(){if(this.destroyed)return;let t,e,n,r,o,s;if(this.fire("destroyed",this.destroyed=!0),this._attachments)for(t in this._attachments)if(this._attachments.hasOwnProperty(t)){for(e=this._attachments[t],n=e.component,r=e.subs,o=0,s=r.length;o<s;o++)n.off(r[o]);e.managingLifecycle&&n.destroy()}if(this._ownedComponents)for(t in this._ownedComponents)this._ownedComponents.hasOwnProperty(t)&&(n=this._ownedComponents[t],n.destroy(),delete this._ownedComponents[t]);this.scene._removeComponent(this),this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this._updateScheduled=!1}}},pVQg:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("tehY");const o=r.a.vec3(),s=(r.a.AABB3(),function(){const t=new Float32Array(16),e=new Float64Array(4),n=new Float64Array(4);return function(o,s,a=t){return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=1,r.a.transformVec4(o,e,n),r.a.setMat4Translation(o,n,a),a}}());function a(t,e,n){const r=Float32Array.from([t[0]])[0],o=t[0]-r,s=Float32Array.from([t[1]])[0],a=t[1]-s,i=Float32Array.from([t[2]])[0],c=t[2]-i;e[0]=r,e[1]=s,e[2]=i,n[0]=o,n[1]=a,n[2]=c}function i(t,e,n,s){const a=r.a.dotVec3(e,n)+t,i=r.a.normalizeVec3(e,o);return r.a.mulVec3Scalar(i,-a,s),s}},tRux:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const r=new(n("jWoc").a)({});class o{constructor(t){this.id=r.addItem({});for(const e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}destroy(){r.removeItem(this.id)}}},tehY:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const r=Float64Array,o=new r(16),s=new r(16),a=new r(4),i={MIN_DOUBLE:-Number.MAX_SAFE_INTEGER,MAX_DOUBLE:Number.MAX_SAFE_INTEGER,DEGTORAD:.0174532925,RADTODEG:57.295779513,unglobalizeObjectId(t,e){const n=e.indexOf("#");return n===t.length&&e.startsWith(t)?e.substring(n+1):e},globalizeObjectId:(t,e)=>t+"#"+e,vec2:t=>new r(t||2),vec3:t=>new r(t||3),vec4:t=>new r(t||4),mat3:t=>new r(t||9),mat3ToMat4:(t,e=new r(16))=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[3],e[5]=t[4],e[6]=t[5],e[7]=0,e[8]=t[6],e[9]=t[7],e[10]=t[8],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e),mat4:t=>new r(t||16),mat4ToMat3(t,e){},doublesToFloats(t,e,n){const r=new Float32Array(2);for(let o=0,s=t.length;o<s;o++)i.splitDouble(t[o],r),e[o]=r[0],n[o]=r[1]},splitDouble(t,e){const n=Float32Array.from([t])[0],r=t-n;e[0]=n,e[1]=r},createUUID:(()=>{const t=[];for(let e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return()=>{const e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return`${t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]}-${t[255&n]}${t[n>>8&255]}-${t[n>>16&15|64]}${t[n>>24&255]}-${t[63&r|128]}${t[r>>8&255]}-${t[r>>16&255]}${t[r>>24&255]}${t[255&o]}${t[o>>8&255]}${t[o>>16&255]}${t[o>>24&255]}`}})(),clamp:(t,e,n)=>Math.max(e,Math.min(n,t)),fmod(t,e){if(t<e)return console.error("math.fmod : Attempting to find modulus within negative range - would be infinite loop - ignoring"),t;for(;e<=t;)t-=e;return t},compareVec3:(t,e)=>t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2],negateVec3:(t,e)=>(e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e),negateVec4:(t,e)=>(e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e),addVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n),addVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n[3]=t[3]+e,n),addVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n),addVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n),subVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n),subVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n),subVec2:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n),geometricMeanVec2(...t){const e=new r(t[0]);for(let n=1;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1];return e[0]/=t.length,e[1]/=t.length,e},subVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]-e,n[3]=t[3]-e,n),subScalarVec4:(t,e,n)=>(n||(n=t),n[0]=e-t[0],n[1]=e-t[1],n[2]=e-t[2],n[3]=e-t[3],n),mulVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n[3]=t[3]*e[3],n),mulVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n),mulVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n),mulVec2Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n),divVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n),divVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n[3]=t[3]/e[3],n),divScalarVec3:(t,e,n)=>(n||(n=e),n[0]=t/e[0],n[1]=t/e[1],n[2]=t/e[2],n),divVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n),divVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n[3]=t[3]/e,n),divScalarVec4:(t,e,n)=>(n||(n=e),n[0]=t/e[0],n[1]=t/e[1],n[2]=t/e[2],n[3]=t/e[3],n),dotVec4:(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],cross3Vec4(t,e){const n=t[0],r=t[1],o=t[2],s=e[0],a=e[1],i=e[2];return[r*i-o*a,o*s-n*i,n*a-r*s,0]},cross3Vec3(t,e,n){n||(n=t);const r=t[0],o=t[1],s=t[2],a=e[0],i=e[1],c=e[2];return n[0]=o*c-s*i,n[1]=s*a-r*c,n[2]=r*i-o*a,n},sqLenVec4:t=>i.dotVec4(t,t),lenVec4:t=>Math.sqrt(i.sqLenVec4(t)),dotVec3:(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2],dotVec2:(t,e)=>t[0]*e[0]+t[1]*e[1],sqLenVec3:t=>i.dotVec3(t,t),sqLenVec2:t=>i.dotVec2(t,t),lenVec3:t=>Math.sqrt(i.sqLenVec3(t)),distVec3:(()=>{const t=new r(3);return(e,n)=>i.lenVec3(i.subVec3(e,n,t))})(),lenVec2:t=>Math.sqrt(i.sqLenVec2(t)),distVec2:(()=>{const t=new r(2);return(e,n)=>i.lenVec2(i.subVec2(e,n,t))})(),rcpVec3:(t,e)=>i.divScalarVec3(1,t,e),normalizeVec4(t,e){const n=1/i.lenVec4(t);return i.mulVec4Scalar(t,n,e)},normalizeVec3(t,e){const n=1/i.lenVec3(t);return i.mulVec3Scalar(t,n,e)},normalizeVec2(t,e){const n=1/i.lenVec2(t);return i.mulVec2Scalar(t,n,e)},angleVec3(t,e){let n=i.dotVec3(t,e)/Math.sqrt(i.sqLenVec3(t)*i.sqLenVec3(e));return n=n<-1?-1:n>1?1:n,Math.acos(n)},vec3FromMat4Scale:(()=>{const t=new r(3);return(e,n)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],n[0]=i.lenVec3(t),t[0]=e[4],t[1]=e[5],t[2]=e[6],n[1]=i.lenVec3(t),t[0]=e[8],t[1]=e[9],t[2]=e[10],n[2]=i.lenVec3(t),n)})(),vecToArray:(()=>{function t(t){return Math.round(1e5*t)/1e5}return e=>{for(let n=0,r=(e=Array.prototype.slice.call(e)).length;n<r;n++)e[n]=t(e[n]);return e}})(),xyzArrayToObject:t=>({x:t[0],y:t[1],z:t[2]}),xyzObjectToArray:(t,e)=>((e=e||new r(3))[0]=t.x,e[1]=t.y,e[2]=t.z,e),dupMat4:t=>t.slice(0,16),mat4To3:t=>[t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]],m4s:t=>[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],setMat4ToZeroes:()=>i.m4s(0),setMat4ToOnes:()=>i.m4s(1),diagonalMat4v:t=>new r([t[0],0,0,0,0,t[1],0,0,0,0,t[2],0,0,0,0,t[3]]),diagonalMat4c:(t,e,n,r)=>i.diagonalMat4v([t,e,n,r]),diagonalMat4s:t=>i.diagonalMat4c(t,t,t,t),identityMat4:(t=new r(16))=>(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),identityMat3:(t=new r(9))=>(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t),isIdentityMat4:t=>1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15],negateMat4:(t,e)=>(e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e),addMat4:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n),addMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n[3]=t[3]+e,n[4]=t[4]+e,n[5]=t[5]+e,n[6]=t[6]+e,n[7]=t[7]+e,n[8]=t[8]+e,n[9]=t[9]+e,n[10]=t[10]+e,n[11]=t[11]+e,n[12]=t[12]+e,n[13]=t[13]+e,n[14]=t[14]+e,n[15]=t[15]+e,n),addScalarMat4:(t,e,n)=>i.addMat4Scalar(e,t,n),subMat4:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n),subMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]-e,n[3]=t[3]-e,n[4]=t[4]-e,n[5]=t[5]-e,n[6]=t[6]-e,n[7]=t[7]-e,n[8]=t[8]-e,n[9]=t[9]-e,n[10]=t[10]-e,n[11]=t[11]-e,n[12]=t[12]-e,n[13]=t[13]-e,n[14]=t[14]-e,n[15]=t[15]-e,n),subScalarMat4:(t,e,n)=>(n||(n=e),n[0]=t-e[0],n[1]=t-e[1],n[2]=t-e[2],n[3]=t-e[3],n[4]=t-e[4],n[5]=t-e[5],n[6]=t-e[6],n[7]=t-e[7],n[8]=t-e[8],n[9]=t-e[9],n[10]=t-e[10],n[11]=t-e[11],n[12]=t-e[12],n[13]=t-e[13],n[14]=t-e[14],n[15]=t-e[15],n),mulMat4(t,e,n){n||(n=t);const r=t[0],o=t[1],s=t[2],a=t[3],i=t[4],c=t[5],l=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],y=t[14],M=t[15],_=e[0],v=e[1],A=e[2],w=e[3],b=e[4],E=e[5],S=e[6],T=e[7],V=e[8],O=e[9],B=e[10],I=e[11],N=e[12],F=e[13],x=e[14],L=e[15];return n[0]=_*r+v*i+A*h+w*m,n[1]=_*o+v*c+A*d+w*g,n[2]=_*s+v*l+A*f+w*y,n[3]=_*a+v*u+A*p+w*M,n[4]=b*r+E*i+S*h+T*m,n[5]=b*o+E*c+S*d+T*g,n[6]=b*s+E*l+S*f+T*y,n[7]=b*a+E*u+S*p+T*M,n[8]=V*r+O*i+B*h+I*m,n[9]=V*o+O*c+B*d+I*g,n[10]=V*s+O*l+B*f+I*y,n[11]=V*a+O*u+B*p+I*M,n[12]=N*r+F*i+x*h+L*m,n[13]=N*o+F*c+x*d+L*g,n[14]=N*s+F*l+x*f+L*y,n[15]=N*a+F*u+x*p+L*M,n},mulMat3(t,e,n){n||(n=new r(9));const o=t[0],s=t[3],a=t[6],i=t[1],c=t[4],l=t[7],u=t[2],h=t[5],d=t[8],f=e[0],p=e[3],m=e[6],g=e[1],y=e[4],M=e[7],_=e[2],v=e[5],A=e[8];return n[0]=o*f+s*g+a*_,n[3]=o*p+s*y+a*v,n[6]=o*m+s*M+a*A,n[1]=i*f+c*g+l*_,n[4]=i*p+c*y+l*v,n[7]=i*m+c*M+l*A,n[2]=u*f+h*g+d*_,n[5]=u*p+h*y+d*v,n[8]=u*m+h*M+d*A,n},mulMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n),mulMat4v4(t,e,n=i.vec4()){const r=e[0],o=e[1],s=e[2],a=e[3];return n[0]=t[0]*r+t[4]*o+t[8]*s+t[12]*a,n[1]=t[1]*r+t[5]*o+t[9]*s+t[13]*a,n[2]=t[2]*r+t[6]*o+t[10]*s+t[14]*a,n[3]=t[3]*r+t[7]*o+t[11]*s+t[15]*a,n},transposeMat4(t,e){const n=t[4],r=t[14],o=t[8],s=t[13],a=t[12],i=t[9];if(!e||t===e){const e=t[1],c=t[2],l=t[3],u=t[6],h=t[7],d=t[11];return t[1]=n,t[2]=o,t[3]=a,t[4]=e,t[6]=i,t[7]=s,t[8]=c,t[9]=u,t[11]=r,t[12]=l,t[13]=h,t[14]=d,t}return e[0]=t[0],e[1]=n,e[2]=o,e[3]=a,e[4]=t[1],e[5]=t[5],e[6]=i,e[7]=s,e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=r,e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},transposeMat3(t,e){if(e===t){const n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},determinantMat4(t){const e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],i=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return f*u*i*o-l*p*i*o-f*a*h*o+s*p*h*o+l*a*m*o-s*u*m*o-f*u*r*c+l*p*r*c+f*n*h*c-e*p*h*c-l*n*m*c+e*u*m*c+f*a*r*d-s*p*r*d-f*n*i*d+e*p*i*d+s*n*m*d-e*a*m*d-l*a*r*g+s*u*r*g+l*n*i*g-e*u*i*g-s*n*h*g+e*a*h*g},inverseMat4(t,e){e||(e=t);const n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],i=t[5],c=t[6],l=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],y=t[15],M=n*i-r*a,_=n*c-o*a,v=n*l-s*a,A=r*c-o*i,w=r*l-s*i,b=o*l-s*c,E=u*m-h*p,S=u*g-d*p,T=u*y-f*p,V=h*g-d*m,O=h*y-f*m,B=d*y-f*g,I=1/(M*B-_*O+v*V+A*T-w*S+b*E);return e[0]=(i*B-c*O+l*V)*I,e[1]=(-r*B+o*O-s*V)*I,e[2]=(m*b-g*w+y*A)*I,e[3]=(-h*b+d*w-f*A)*I,e[4]=(-a*B+c*T-l*S)*I,e[5]=(n*B-o*T+s*S)*I,e[6]=(-p*b+g*v-y*_)*I,e[7]=(u*b-d*v+f*_)*I,e[8]=(a*O-i*T+l*E)*I,e[9]=(-n*O+r*T-s*E)*I,e[10]=(p*w-m*v+y*M)*I,e[11]=(-u*w+h*v-f*M)*I,e[12]=(-a*V+i*S-c*E)*I,e[13]=(n*V-r*S+o*E)*I,e[14]=(-p*A+m*_-g*M)*I,e[15]=(u*A-h*_+d*M)*I,e},traceMat4:t=>t[0]+t[5]+t[10]+t[15],translationMat4v(t,e){const n=e||i.identityMat4();return n[12]=t[0],n[13]=t[1],n[14]=t[2],n},translationMat3v(t,e){const n=e||i.identityMat3();return n[6]=t[0],n[7]=t[1],n},translationMat4c:(()=>{const t=new r(3);return(e,n,r,o)=>(t[0]=e,t[1]=n,t[2]=r,i.translationMat4v(t,o))})(),translationMat4s:(t,e)=>i.translationMat4c(t,t,t,e),translateMat4v:(t,e)=>i.translateMat4c(t[0],t[1],t[2],e),OLDtranslateMat4c(t,e,n,r){const o=r[12];r[0]+=o*t,r[4]+=o*e,r[8]+=o*n;const s=r[13];r[1]+=s*t,r[5]+=s*e,r[9]+=s*n;const a=r[14];r[2]+=a*t,r[6]+=a*e,r[10]+=a*n;const i=r[15];return r[3]+=i*t,r[7]+=i*e,r[11]+=i*n,r},translateMat4c(t,e,n,r){const o=r[3];r[0]+=o*t,r[1]+=o*e,r[2]+=o*n;const s=r[7];r[4]+=s*t,r[5]+=s*e,r[6]+=s*n;const a=r[11];r[8]+=a*t,r[9]+=a*e,r[10]+=a*n;const i=r[15];return r[12]+=i*t,r[13]+=i*e,r[14]+=i*n,r},setMat4Translation:(t,e,n)=>(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=t[15],n),rotationMat4v(t,e,n){const r=i.normalizeVec4([e[0],e[1],e[2],0],[]),o=Math.sin(t),s=Math.cos(t),a=1-s,c=r[0],l=r[1],u=r[2];let h,d,f,p,m,g;return h=c*l,d=l*u,f=u*c,p=c*o,m=l*o,g=u*o,(n=n||i.mat4())[0]=a*c*c+s,n[1]=a*h+g,n[2]=a*f-m,n[3]=0,n[4]=a*h-g,n[5]=a*l*l+s,n[6]=a*d+p,n[7]=0,n[8]=a*f+m,n[9]=a*d-p,n[10]=a*u*u+s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rotationMat4c:(t,e,n,r,o)=>i.rotationMat4v(t,[e,n,r],o),scalingMat4v:(t,e=i.identityMat4())=>(e[0]=t[0],e[5]=t[1],e[10]=t[2],e),scalingMat3v:(t,e=i.identityMat3())=>(e[0]=t[0],e[4]=t[1],e),scalingMat4c:(()=>{const t=new r(3);return(e,n,r,o)=>(t[0]=e,t[1]=n,t[2]=r,i.scalingMat4v(t,o))})(),scaleMat4c:(t,e,n,r)=>(r[0]*=t,r[4]*=e,r[8]*=n,r[1]*=t,r[5]*=e,r[9]*=n,r[2]*=t,r[6]*=e,r[10]*=n,r[3]*=t,r[7]*=e,r[11]*=n,r),scaleMat4v(t,e){const n=t[0],r=t[1],o=t[2];return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,e},scalingMat4s:t=>i.scalingMat4c(t,t,t),rotationTranslationMat4(t,e,n=i.mat4()){const r=t[0],o=t[1],s=t[2],a=t[3],c=r+r,l=o+o,u=s+s,h=r*c,d=r*l,f=r*u,p=o*l,m=o*u,g=s*u,y=a*c,M=a*l,_=a*u;return n[0]=1-(p+g),n[1]=d+_,n[2]=f-M,n[3]=0,n[4]=d-_,n[5]=1-(h+g),n[6]=m+y,n[7]=0,n[8]=f+M,n[9]=m-y,n[10]=1-(h+p),n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n},mat4ToEuler(t,e,n=i.vec4()){const r=i.clamp,o=t[0],s=t[4],a=t[8],c=t[1],l=t[5],u=t[9],h=t[2],d=t[6],f=t[10];return"XYZ"===e?(n[1]=Math.asin(r(a,-1,1)),Math.abs(a)<.99999?(n[0]=Math.atan2(-u,f),n[2]=Math.atan2(-s,o)):(n[0]=Math.atan2(d,l),n[2]=0)):"YXZ"===e?(n[0]=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(n[1]=Math.atan2(a,f),n[2]=Math.atan2(c,l)):(n[1]=Math.atan2(-h,o),n[2]=0)):"ZXY"===e?(n[0]=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(n[1]=Math.atan2(-h,f),n[2]=Math.atan2(-s,l)):(n[1]=0,n[2]=Math.atan2(c,o))):"ZYX"===e?(n[1]=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(n[0]=Math.atan2(d,f),n[2]=Math.atan2(c,o)):(n[0]=0,n[2]=Math.atan2(-s,l))):"YZX"===e?(n[2]=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(n[0]=Math.atan2(-u,l),n[1]=Math.atan2(-h,o)):(n[0]=0,n[1]=Math.atan2(a,f))):"XZY"===e&&(n[2]=Math.asin(-r(s,-1,1)),Math.abs(s)<.99999?(n[0]=Math.atan2(d,l),n[1]=Math.atan2(a,o)):(n[0]=Math.atan2(-u,f),n[1]=0)),n},composeMat4:(t,e,n,r=i.mat4())=>(i.quaternionToRotationMat4(e,r),i.scaleMat4v(n,r),i.translateMat4v(t,r),r),decomposeMat4:(()=>{const t=new r(3),e=new r(16);return function(n,r,o,s){t[0]=n[0],t[1]=n[1],t[2]=n[2];let a=i.lenVec3(t);t[0]=n[4],t[1]=n[5],t[2]=n[6];const c=i.lenVec3(t);t[8]=n[8],t[9]=n[9],t[10]=n[10];const l=i.lenVec3(t);i.determinantMat4(n)<0&&(a=-a),r[0]=n[12],r[1]=n[13],r[2]=n[14],e.set(n);const u=1/a,h=1/c,d=1/l;return e[0]*=u,e[1]*=u,e[2]*=u,e[4]*=h,e[5]*=h,e[6]*=h,e[8]*=d,e[9]*=d,e[10]*=d,i.mat4ToQuaternion(e,o),s[0]=a,s[1]=c,s[2]=l,this}})(),getColMat4(t,e){const n=4*e;return[t[n],t[n+1],t[n+2],t[n+3]]},setRowMat4(t,e,n){t[e]=n[0],t[e+4]=n[1],t[e+8]=n[2],t[e+12]=n[3]},lookAtMat4v(t,e,n,r){r||(r=i.mat4());const o=t[0],s=t[1],a=t[2],c=n[0],l=n[1],u=n[2],h=e[0],d=e[1],f=e[2];if(o===h&&s===d&&a===f)return i.identityMat4();let p,m,g,y,M,_,v,A,w,b;return p=o-h,m=s-d,g=a-f,b=1/Math.sqrt(p*p+m*m+g*g),p*=b,m*=b,g*=b,y=l*g-u*m,M=u*p-c*g,_=c*m-l*p,b=Math.sqrt(y*y+M*M+_*_),b?(b=1/b,y*=b,M*=b,_*=b):(y=0,M=0,_=0),v=m*_-g*M,A=g*y-p*_,w=p*M-m*y,b=Math.sqrt(v*v+A*A+w*w),b?(b=1/b,v*=b,A*=b,w*=b):(v=0,A=0,w=0),r[0]=y,r[1]=v,r[2]=p,r[3]=0,r[4]=M,r[5]=A,r[6]=m,r[7]=0,r[8]=_,r[9]=w,r[10]=g,r[11]=0,r[12]=-(y*o+M*s+_*a),r[13]=-(v*o+A*s+w*a),r[14]=-(p*o+m*s+g*a),r[15]=1,r},lookAtMat4c:(t,e,n,r,o,s,a,c,l)=>i.lookAtMat4v([t,e,n],[r,o,s],[a,c,l],[]),orthoMat4c(t,e,n,r,o,s,a){a||(a=i.mat4());const c=e-t,l=r-n,u=s-o;return a[0]=2/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2/u,a[11]=0,a[12]=-(t+e)/c,a[13]=-(r+n)/l,a[14]=-(s+o)/u,a[15]=1,a},frustumMat4v(t,e,n){n||(n=i.mat4());const r=[t[0],t[1],t[2],0],a=[e[0],e[1],e[2],0];i.addVec4(a,r,o),i.subVec4(a,r,s);const c=2*r[2],l=s[0],u=s[1],h=s[2];return n[0]=c/l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c/u,n[6]=0,n[7]=0,n[8]=o[0]/l,n[9]=o[1]/u,n[10]=-o[2]/h,n[11]=-1,n[12]=0,n[13]=0,n[14]=-c*a[2]/h,n[15]=0,n},frustumMat4(t,e,n,r,o,s,a){a||(a=i.mat4());const c=e-t,l=r-n,u=s-o;return a[0]=2*o/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*o/l,a[6]=0,a[7]=0,a[8]=(e+t)/c,a[9]=(r+n)/l,a[10]=-(s+o)/u,a[11]=-1,a[12]=0,a[13]=0,a[14]=-s*o*2/u,a[15]=0,a},perspectiveMat4(t,e,n,r,o){const s=[],a=[];return s[2]=n,a[2]=r,a[1]=s[2]*Math.tan(t/2),s[1]=-a[1],a[0]=a[1]*e,s[0]=-a[0],i.frustumMat4v(s,a,o)},compareMat4:(t,e)=>t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15],transformPoint3(t,e,n=i.vec3()){const r=e[0],o=e[1],s=e[2];return n[0]=t[0]*r+t[4]*o+t[8]*s+t[12],n[1]=t[1]*r+t[5]*o+t[9]*s+t[13],n[2]=t[2]*r+t[6]*o+t[10]*s+t[14],n},transformPoint4:(t,e,n=i.vec4())=>(n[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],n[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],n[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],n[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],n),transformPoints3(t,e,n){const r=n||[],o=e.length;let s,a,i,c;const l=t[0],u=t[1],h=t[2],d=t[3],f=t[4],p=t[5],m=t[6],g=t[7],y=t[8],M=t[9],_=t[10],v=t[11],A=t[12],w=t[13],b=t[14],E=t[15];let S;for(let T=0;T<o;++T)c=e[T],s=c[0],a=c[1],i=c[2],S=r[T]||(r[T]=[0,0,0]),S[0]=l*s+f*a+y*i+A,S[1]=u*s+p*a+M*i+w,S[2]=h*s+m*a+_*i+b,S[3]=d*s+g*a+v*i+E;return r.length=o,r},transformPositions3(t,e,n=e){let r;const o=e.length;let s,a,i;const c=t[0],l=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],m=t[7],g=t[8],y=t[9],M=t[10],_=t[11],v=t[12],A=t[13],w=t[14],b=t[15];for(r=0;r<o;r+=3)s=e[r+0],a=e[r+1],i=e[r+2],n[r+0]=c*s+d*a+g*i+v,n[r+1]=l*s+f*a+y*i+A,n[r+2]=u*s+p*a+M*i+w,n[r+3]=h*s+m*a+_*i+b;return n},transformPositions4(t,e,n=e){let r;const o=e.length;let s,a,i;const c=t[0],l=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],m=t[7],g=t[8],y=t[9],M=t[10],_=t[11],v=t[12],A=t[13],w=t[14],b=t[15];for(r=0;r<o;r+=4)s=e[r+0],a=e[r+1],i=e[r+2],n[r+0]=c*s+d*a+g*i+v,n[r+1]=l*s+f*a+y*i+A,n[r+2]=u*s+p*a+M*i+w,n[r+3]=h*s+m*a+_*i+b;return n},transformVec3(t,e,n){const r=e[0],o=e[1],s=e[2];return(n=n||this.vec3())[0]=t[0]*r+t[4]*o+t[8]*s,n[1]=t[1]*r+t[5]*o+t[9]*s,n[2]=t[2]*r+t[6]*o+t[10]*s,n},transformVec4(t,e,n){const r=e[0],o=e[1],s=e[2],a=e[3];return(n=n||i.vec4())[0]=t[0]*r+t[4]*o+t[8]*s+t[12]*a,n[1]=t[1]*r+t[5]*o+t[9]*s+t[13]*a,n[2]=t[2]*r+t[6]*o+t[10]*s+t[14]*a,n[3]=t[3]*r+t[7]*o+t[11]*s+t[15]*a,n},rotateVec3X(t,e,n,r){const o=[],s=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],s[0]=o[0],s[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),s[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r},rotateVec3Y(t,e,n,r){const o=[],s=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],s[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),s[1]=o[1],s[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r},rotateVec3Z(t,e,n,r){const o=[],s=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],s[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),s[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),s[2]=o[2],r[0]=s[0]+e[0],r[1]=s[1]+e[1],r[2]=s[2]+e[2],r},projectVec4(t,e){const n=1/t[3];return(e=e||i.vec2())[0]=t[0]*n,e[1]=t[1]*n,e},unprojectVec3:(()=>{const t=new r(16),e=new r(16),n=new r(16);return function(r,o,s,a){return this.transformVec3(this.mulMat4(this.inverseMat4(o,t),this.inverseMat4(s,e),n),r,a)}})(),lerpVec3(t,e,n,r,o,s){const a=s||i.vec3(),c=(t-e)/(n-e);return a[0]=r[0]+c*(o[0]-r[0]),a[1]=r[1]+c*(o[1]-r[1]),a[2]=r[2]+c*(o[2]-r[2]),a},lerpMat4(t,e,n,r,o,s){const a=s||i.mat4(),c=(t-e)/(n-e);return a[0]=r[0]+c*(o[0]-r[0]),a[1]=r[1]+c*(o[1]-r[1]),a[2]=r[2]+c*(o[2]-r[2]),a[3]=r[3]+c*(o[3]-r[3]),a[4]=r[4]+c*(o[4]-r[4]),a[5]=r[5]+c*(o[5]-r[5]),a[6]=r[6]+c*(o[6]-r[6]),a[7]=r[7]+c*(o[7]-r[7]),a[8]=r[8]+c*(o[8]-r[8]),a[9]=r[9]+c*(o[9]-r[9]),a[10]=r[10]+c*(o[10]-r[10]),a[11]=r[11]+c*(o[11]-r[11]),a[12]=r[12]+c*(o[12]-r[12]),a[13]=r[13]+c*(o[13]-r[13]),a[14]=r[14]+c*(o[14]-r[14]),a[15]=r[15]+c*(o[15]-r[15]),a},flatten(t){const e=[];let n,r,o,s,a;for(n=0,r=t.length;n<r;n++)for(a=t[n],o=0,s=a.length;o<s;o++)e.push(a[o]);return e},identityQuaternion:(t=i.vec4())=>(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t),eulerToQuaternion(t,e,n=i.vec4()){const r=t[0]*i.DEGTORAD/2,o=t[1]*i.DEGTORAD/2,s=t[2]*i.DEGTORAD/2,a=Math.cos(r),c=Math.cos(o),l=Math.cos(s),u=Math.sin(r),h=Math.sin(o),d=Math.sin(s);return"XYZ"===e?(n[0]=u*c*l+a*h*d,n[1]=a*h*l-u*c*d,n[2]=a*c*d+u*h*l,n[3]=a*c*l-u*h*d):"YXZ"===e?(n[0]=u*c*l+a*h*d,n[1]=a*h*l-u*c*d,n[2]=a*c*d-u*h*l,n[3]=a*c*l+u*h*d):"ZXY"===e?(n[0]=u*c*l-a*h*d,n[1]=a*h*l+u*c*d,n[2]=a*c*d+u*h*l,n[3]=a*c*l-u*h*d):"ZYX"===e?(n[0]=u*c*l-a*h*d,n[1]=a*h*l+u*c*d,n[2]=a*c*d-u*h*l,n[3]=a*c*l+u*h*d):"YZX"===e?(n[0]=u*c*l+a*h*d,n[1]=a*h*l+u*c*d,n[2]=a*c*d-u*h*l,n[3]=a*c*l-u*h*d):"XZY"===e&&(n[0]=u*c*l-a*h*d,n[1]=a*h*l-u*c*d,n[2]=a*c*d+u*h*l,n[3]=a*c*l+u*h*d),n},mat4ToQuaternion(t,e=i.vec4()){const n=t[0],r=t[4],o=t[8],s=t[1],a=t[5],c=t[9],l=t[2],u=t[6],h=t[10];let d;const f=n+a+h;return f>0?(d=.5/Math.sqrt(f+1),e[3]=.25/d,e[0]=(u-c)*d,e[1]=(o-l)*d,e[2]=(s-r)*d):n>a&&n>h?(d=2*Math.sqrt(1+n-a-h),e[3]=(u-c)/d,e[0]=.25*d,e[1]=(r+s)/d,e[2]=(o+l)/d):a>h?(d=2*Math.sqrt(1+a-n-h),e[3]=(o-l)/d,e[0]=(r+s)/d,e[1]=.25*d,e[2]=(c+u)/d):(d=2*Math.sqrt(1+h-n-a),e[3]=(s-r)/d,e[0]=(o+l)/d,e[1]=(c+u)/d,e[2]=.25*d),e},vec3PairToQuaternion(t,e,n=i.vec4()){const r=Math.sqrt(i.dotVec3(t,t)*i.dotVec3(e,e));let o=r+i.dotVec3(t,e);return o<1e-8*r?(o=0,Math.abs(t[0])>Math.abs(t[2])?(n[0]=-t[1],n[1]=t[0],n[2]=0):(n[0]=0,n[1]=-t[2],n[2]=t[1])):i.cross3Vec3(t,e,n),n[3]=o,i.normalizeQuaternion(n)},angleAxisToQuaternion(t,e=i.vec4()){const n=t[3]/2,r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},quaternionToEuler:(()=>{const t=new r(16);return(e,n,r)=>(r=r||i.vec3(),i.quaternionToRotationMat4(e,t),i.mat4ToEuler(t,n,r),r)})(),mulQuaternions(t,e,n=i.vec4()){const r=t[0],o=t[1],s=t[2],a=t[3],c=e[0],l=e[1],u=e[2],h=e[3];return n[0]=a*c+r*h+o*u-s*l,n[1]=a*l+o*h+s*c-r*u,n[2]=a*u+s*h+r*l-o*c,n[3]=a*h-r*c-o*l-s*u,n},vec3ApplyQuaternion(t,e,n=i.vec3()){const r=e[0],o=e[1],s=e[2],a=t[0],c=t[1],l=t[2],u=t[3],h=u*r+c*s-l*o,d=u*o+l*r-a*s,f=u*s+a*o-c*r,p=-a*r-c*o-l*s;return n[0]=h*u+p*-a+d*-l-f*-c,n[1]=d*u+p*-c+f*-a-h*-l,n[2]=f*u+p*-l+h*-c-d*-a,n},quaternionToMat4(t,e){e=i.identityMat4(e);const n=t[0],r=t[1],o=t[2],s=t[3],a=2*n,c=2*r,l=2*o,u=a*s,h=c*s,d=l*s,f=a*n,p=c*n,m=l*n,g=c*r,y=l*r,M=l*o;return e[0]=1-(g+M),e[1]=p+d,e[2]=m-h,e[4]=p-d,e[5]=1-(f+M),e[6]=y+u,e[8]=m+h,e[9]=y-u,e[10]=1-(f+g),e},quaternionToRotationMat4(t,e){const n=t[0],r=t[1],o=t[2],s=t[3],a=n+n,i=r+r,c=o+o,l=n*a,u=n*i,h=n*c,d=r*i,f=r*c,p=o*c,m=s*a,g=s*i,y=s*c;return e[0]=1-(d+p),e[4]=u-y,e[8]=h+g,e[1]=u+y,e[5]=1-(l+p),e[9]=f-m,e[2]=h-g,e[6]=f+m,e[10]=1-(l+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},normalizeQuaternion(t,e=t){const n=i.lenVec4([t[0],t[1],t[2],t[3]]);return e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n,e[3]=t[3]/n,e},conjugateQuaternion:(t,e=t)=>(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e),inverseQuaternion:(t,e)=>i.normalizeQuaternion(i.conjugateQuaternion(t,e)),quaternionToAngleAxis(t,e=i.vec4()){const n=(t=i.normalizeQuaternion(t,a))[3],r=2*Math.acos(n),o=Math.sqrt(1-n*n);return o<.001?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):(e[0]=t[0]/o,e[1]=t[1]/o,e[2]=t[2]/o),e[3]=r,e},AABB3:t=>new r(t||6),AABB2:t=>new r(t||4),OBB3:t=>new r(t||32),OBB2:t=>new r(t||16),Sphere3:(t,e,n,o)=>new r([t,e,n,o]),transformOBB3(t,e,n=e){let r;const o=e.length;let s,a,i;const c=t[0],l=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],m=t[7],g=t[8],y=t[9],M=t[10],_=t[11],v=t[12],A=t[13],w=t[14],b=t[15];for(r=0;r<o;r+=4)s=e[r+0],a=e[r+1],i=e[r+2],n[r+0]=c*s+d*a+g*i+v,n[r+1]=l*s+f*a+y*i+A,n[r+2]=u*s+p*a+M*i+w,n[r+3]=h*s+m*a+_*i+b;return n},containsAABB3:function(t,e){return t[0]<=e[0]&&e[3]<=t[3]&&t[1]<=e[1]&&e[4]<=t[4]&&t[2]<=e[2]&&e[5]<=t[5]},getAABB3Diag:(()=>{const t=new r(3),e=new r(3),n=new r(3);return r=>(t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5],i.subVec3(e,t,n),Math.abs(i.lenVec3(n)))})(),getAABB3DiagPoint:(()=>{const t=new r(3),e=new r(3),n=new r(3);return(r,o)=>{t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5];const s=i.subVec3(e,t,n),a=o[0]-r[0],c=r[3]-o[0],l=o[1]-r[1],u=r[4]-o[1],h=o[2]-r[2],d=r[5]-o[2];return s[0]+=a>c?a:c,s[1]+=l>u?l:u,s[2]+=h>d?h:d,Math.abs(i.lenVec3(s))}})(),getAABB3Area:t=>(t[3]-t[0])*(t[4]-t[1])*(t[5]-t[2]),getAABB3Center(t,e){const n=e||i.vec3();return n[0]=(t[0]+t[3])/2,n[1]=(t[1]+t[4])/2,n[2]=(t[2]+t[5])/2,n},getAABB2Center(t,e){const n=e||i.vec2();return n[0]=(t[2]+t[0])/2,n[1]=(t[3]+t[1])/2,n},collapseAABB3:(t=i.AABB3())=>(t[0]=i.MAX_DOUBLE,t[1]=i.MAX_DOUBLE,t[2]=i.MAX_DOUBLE,t[3]=i.MIN_DOUBLE,t[4]=i.MIN_DOUBLE,t[5]=i.MIN_DOUBLE,t),AABB3ToOBB3:(t,e=i.OBB3())=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1,e[4]=t[3],e[5]=t[1],e[6]=t[2],e[7]=1,e[8]=t[3],e[9]=t[4],e[10]=t[2],e[11]=1,e[12]=t[0],e[13]=t[4],e[14]=t[2],e[15]=1,e[16]=t[0],e[17]=t[1],e[18]=t[5],e[19]=1,e[20]=t[3],e[21]=t[1],e[22]=t[5],e[23]=1,e[24]=t[3],e[25]=t[4],e[26]=t[5],e[27]=1,e[28]=t[0],e[29]=t[4],e[30]=t[5],e[31]=1,e),positions3ToAABB3:(()=>{const t=new Float32Array(3);return(e,n,r)=>{n=n||i.AABB3();let o,s,a,c=i.MAX_DOUBLE,l=i.MAX_DOUBLE,u=i.MAX_DOUBLE,h=i.MIN_DOUBLE,d=i.MIN_DOUBLE,f=i.MIN_DOUBLE;for(let p=0,m=e.length;p<m;p+=3)r?(t[0]=e[p+0],t[1]=e[p+1],t[2]=e[p+2],i.decompressPosition(t,r,t),o=t[0],s=t[1],a=t[2]):(o=e[p+0],s=e[p+1],a=e[p+2]),o<c&&(c=o),s<l&&(l=s),a<u&&(u=a),o>h&&(h=o),s>d&&(d=s),a>f&&(f=a);return n[0]=c,n[1]=l,n[2]=u,n[3]=h,n[4]=d,n[5]=f,n}})(),OBB3ToAABB3(t,e=i.AABB3()){let n,r,o,s=i.MAX_DOUBLE,a=i.MAX_DOUBLE,c=i.MAX_DOUBLE,l=i.MIN_DOUBLE,u=i.MIN_DOUBLE,h=i.MIN_DOUBLE;for(let i=0,d=t.length;i<d;i+=4)n=t[i+0],r=t[i+1],o=t[i+2],n<s&&(s=n),r<a&&(a=r),o<c&&(c=o),n>l&&(l=n),r>u&&(u=r),o>h&&(h=o);return e[0]=s,e[1]=a,e[2]=c,e[3]=l,e[4]=u,e[5]=h,e},points3ToAABB3(t,e=i.AABB3()){let n,r,o,s=i.MAX_DOUBLE,a=i.MAX_DOUBLE,c=i.MAX_DOUBLE,l=i.MIN_DOUBLE,u=i.MIN_DOUBLE,h=i.MIN_DOUBLE;for(let i=0,d=t.length;i<d;i++)n=t[i][0],r=t[i][1],o=t[i][2],n<s&&(s=n),r<a&&(a=r),o<c&&(c=o),n>l&&(l=n),r>u&&(u=r),o>h&&(h=o);return e[0]=s,e[1]=a,e[2]=c,e[3]=l,e[4]=u,e[5]=h,e},points3ToSphere3:(()=>{const t=new Float32Array(3);return(e,n)=>{n=n||i.vec4();let r,o=0,s=0,a=0;const c=e.length;for(r=0;r<c;r++)o+=e[r][0],s+=e[r][1],a+=e[r][2];n[0]=o/c,n[1]=s/c,n[2]=a/c;let l,u=0;for(r=0;r<c;r++)l=Math.abs(i.lenVec3(i.subVec3(e[r],n,t))),l>u&&(u=l);return n[3]=u,n}})(),positions3ToSphere3:(()=>{const t=new Float32Array(3),e=new Float32Array(3);return(n,r)=>{r=r||i.vec4();let o,s=0,a=0,c=0;const l=n.length;let u=0;for(o=0;o<l;o+=3)s+=n[o],a+=n[o+1],c+=n[o+2];const h=l/3;let d;for(r[0]=s/h,r[1]=a/h,r[2]=c/h,o=0;o<l;o+=3)t[0]=n[o],t[1]=n[o+1],t[2]=n[o+2],d=Math.abs(i.lenVec3(i.subVec3(t,r,e))),d>u&&(u=d);return r[3]=u,r}})(),OBB3ToSphere3:(()=>{const t=new Float32Array(3),e=new Float32Array(3);return(n,r)=>{r=r||i.vec4();let o,s=0,a=0,c=0;const l=n.length,u=l/4;for(o=0;o<l;o+=4)s+=n[o+0],a+=n[o+1],c+=n[o+2];r[0]=s/u,r[1]=a/u,r[2]=c/u;let h,d=0;for(o=0;o<l;o+=4)t[0]=n[o+0],t[1]=n[o+1],t[2]=n[o+2],h=Math.abs(i.lenVec3(i.subVec3(t,r,e))),h>d&&(d=h);return r[3]=d,r}})(),getSphere3Center:(t,e=i.vec3())=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e),getPositionsCenter(t,e=i.vec3()){let n=0,r=0,o=0;for(var s=0,a=t.length;s<a;s+=3)n+=t[s+0],r+=t[s+1],o+=t[s+2];const c=t.length/3;return e[0]=n/c,e[1]=r/c,e[2]=o/c,e},expandAABB3:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]>e[2]&&(t[2]=e[2]),t[3]<e[3]&&(t[3]=e[3]),t[4]<e[4]&&(t[4]=e[4]),t[5]<e[5]&&(t[5]=e[5]),t),expandAABB3Point3:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]>e[2]&&(t[2]=e[2]),t[3]<e[0]&&(t[3]=e[0]),t[4]<e[1]&&(t[4]=e[1]),t[5]<e[2]&&(t[5]=e[2]),t),expandAABB3Points3(t,e){for(var n,r,o,s=0,a=e.length;s<a;s+=3)n=e[s],r=e[s+1],o=e[s+2],t[0]>n&&(t[0]=n),t[1]>r&&(t[1]=r),t[2]>o&&(t[2]=o),t[3]<n&&(t[3]=n),t[4]<r&&(t[4]=r),t[5]<o&&(t[5]=o);return t},collapseAABB2:(t=i.AABB2())=>(t[0]=i.MAX_DOUBLE,t[1]=i.MAX_DOUBLE,t[2]=i.MIN_DOUBLE,t[3]=i.MIN_DOUBLE,t),point3AABB3Intersect:(t,e)=>t[0]>e[0]||t[3]<e[0]||t[1]>e[1]||t[4]<e[1]||t[2]>e[2]||t[5]<e[2],planeAABB3Intersect(t,e,n){let r,o;t[0]>0?(r=t[0]*n[0],o=t[0]*n[3]):(r=t[0]*n[3],o=t[0]*n[0]),t[1]>0?(r+=t[1]*n[1],o+=t[1]*n[4]):(r+=t[1]*n[4],o+=t[1]*n[1]),t[2]>0?(r+=t[2]*n[2],o+=t[2]*n[5]):(r+=t[2]*n[5],o+=t[2]*n[2]);if(r<=-e&&o<=-e)return-1;return r>=-e&&o>=-e?1:0},OBB3ToAABB2(t,e=i.AABB2()){let n,r,o,s,a=i.MAX_DOUBLE,c=i.MAX_DOUBLE,l=i.MIN_DOUBLE,u=i.MIN_DOUBLE;for(let i=0,h=t.length;i<h;i+=4)n=t[i+0],r=t[i+1],o=t[i+3]||1,s=1/o,n*=s,r*=s,n<a&&(a=n),r<c&&(c=r),n>l&&(l=n),r>u&&(u=r);return e[0]=a,e[1]=c,e[2]=l,e[3]=u,e},expandAABB2:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[2]&&(t[2]=e[2]),t[3]<e[3]&&(t[3]=e[3]),t),expandAABB2Point2:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1]),t),AABB2ToCanvas(t,e,n,r=t){const o=.5*(t[0]+1),s=.5*(t[1]+1),a=.5*(t[2]+1),i=.5*(t[3]+1);return r[0]=Math.floor(o*e),r[1]=n-Math.floor(i*n),r[2]=Math.floor(a*e),r[3]=n-Math.floor(s*n),r},tangentQuadraticBezier:(t,e,n,r)=>2*(1-t)*(n-e)+2*t*(r-n),tangentQuadraticBezier3:(t,e,n,r,o)=>-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*r*(1-t)-3*t*t*r+3*t*t*o,tangentSpline:t=>6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t),catmullRomInterpolate(t,e,n,r,o){const s=.5*(n-t),a=.5*(r-e),i=o*o;return(2*e-2*n+s+a)*(o*i)+(-3*e+3*n-2*s-a)*i+s*o+e},b2p0(t,e){const n=1-t;return n*n*e},b2p1:(t,e)=>2*(1-t)*t*e,b2p2:(t,e)=>t*t*e,b2(t,e,n,r){return this.b2p0(t,e)+this.b2p1(t,n)+this.b2p2(t,r)},b3p0(t,e){const n=1-t;return n*n*n*e},b3p1(t,e){const n=1-t;return 3*n*n*t*e},b3p2:(t,e)=>3*(1-t)*t*t*e,b3p3:(t,e)=>t*t*t*e,b3(t,e,n,r,o){return this.b3p0(t,e)+this.b3p1(t,n)+this.b3p2(t,r)+this.b3p3(t,o)},triangleNormal(t,e,n,r=i.vec3()){const o=e[0]-t[0],s=e[1]-t[1],a=e[2]-t[2],c=n[0]-t[0],l=n[1]-t[1],u=n[2]-t[2],h=s*u-a*l,d=a*c-o*u,f=o*l-s*c,p=Math.sqrt(h*h+d*d+f*f);return 0===p?(r[0]=0,r[1]=0,r[2]=0):(r[0]=h/p,r[1]=d/p,r[2]=f/p),r},rayTriangleIntersect:(()=>{const t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3);return(s,a,c,l,u,h)=>{h=h||i.vec3();const d=i.subVec3(l,c,t),f=i.subVec3(u,c,e),p=i.cross3Vec3(a,f,n),m=i.dotVec3(d,p);if(m<1e-6)return null;const g=i.subVec3(s,c,r),y=i.dotVec3(g,p);if(y<0||y>m)return null;const M=i.cross3Vec3(g,d,o),_=i.dotVec3(a,M);if(_<0||y+_>m)return null;const v=i.dotVec3(f,M)/m;return h[0]=s[0]+v*a[0],h[1]=s[1]+v*a[1],h[2]=s[2]+v*a[2],h}})(),rayPlaneIntersect:(()=>{const t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3);return(o,s,a,c,l,u)=>{u=u||i.vec3(),s=i.normalizeVec3(s,t);const h=i.subVec3(c,a,e),d=i.subVec3(l,a,n),f=i.cross3Vec3(h,d,r);i.normalizeVec3(f,f);const p=-i.dotVec3(a,f),m=-(i.dotVec3(o,f)+p)/i.dotVec3(s,f);return u[0]=o[0]+m*s[0],u[1]=o[1]+m*s[1],u[2]=o[2]+m*s[2],u}})(),cartesianToBarycentric:(()=>{const t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3);return(r,o,s,a,c)=>{const l=i.subVec3(a,o,t),u=i.subVec3(s,o,e),h=i.subVec3(r,o,n),d=i.dotVec3(l,l),f=i.dotVec3(l,u),p=i.dotVec3(l,h),m=i.dotVec3(u,u),g=i.dotVec3(u,h),y=d*m-f*f;if(0===y)return null;const M=1/y,_=(m*p-f*g)*M,v=(d*g-f*p)*M;return c[0]=1-_-v,c[1]=v,c[2]=_,c}})(),barycentricInsideTriangle(t){const e=t[1],n=t[2];return n>=0&&e>=0&&n+e<1},barycentricToCartesian(t,e,n,r,o=i.vec3()){const s=t[0],a=t[1],c=t[2];return o[0]=e[0]*s+n[0]*a+r[0]*c,o[1]=e[1]*s+n[1]*a+r[1]*c,o[2]=e[2]*s+n[2]*a+r[2]*c,o},mergeVertices(t,e,n,r){const o={},s=[],a=[],i=e?[]:null,c=n?[]:null,l=[];let u,h,d,f;const p=1e4;let m,g,y=0;for(m=0,g=t.length;m<g;m+=3)u=t[m],h=t[m+1],d=t[m+2],f=`${Math.round(u*p)}_${Math.round(h*p)}_${Math.round(d*p)}`,void 0===o[f]&&(o[f]=a.length/3,a.push(u),a.push(h),a.push(d),e&&(i.push(e[m]),i.push(e[m+1]),i.push(e[m+2])),n&&(c.push(n[y]),c.push(n[y+1]))),s[m/3]=o[f],y+=2;for(m=0,g=r.length;m<g;m++)l[m]=s[r[m]];const M={positions:a,indices:l};return i&&(M.normals=i),c&&(M.uv=c),M},buildNormals:(()=>{const t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3);return(a,c,l)=>{let u,h;const d=new Array(a.length/3);let f,p,m,g,y,M,_;for(u=0,h=c.length;u<h;u+=3){f=c[u],p=c[u+1],m=c[u+2],t[0]=a[3*f],t[1]=a[3*f+1],t[2]=a[3*f+2],e[0]=a[3*p],e[1]=a[3*p+1],e[2]=a[3*p+2],n[0]=a[3*m],n[1]=a[3*m+1],n[2]=a[3*m+2],i.subVec3(e,t,r),i.subVec3(n,t,o);const l=new Float32Array(3);i.normalizeVec3(i.cross3Vec3(r,o,s),l),d[f]||(d[f]=[]),d[p]||(d[p]=[]),d[m]||(d[m]=[]),d[f].push(l),d[p].push(l),d[m].push(l)}for(l=l&&l.length===a.length?l:new Float32Array(a.length),u=0,h=d.length;u<h;u++){g=d[u].length,y=0,M=0,_=0;for(let t=0;t<g;t++)y+=d[u][t][0],M+=d[u][t][1],_+=d[u][t][2];l[3*u]=y/g,l[3*u+1]=M/g,l[3*u+2]=_/g}return l}})(),buildTangents:(()=>{const t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3),a=new Float32Array(3);return(c,l,u)=>{const h=new Float32Array(c.length);for(let d=0;d<l.length;d+=3){let f=l[d];const p=c.subarray(3*f,3*f+3),m=u.subarray(2*f,2*f+2);f=l[d+1];const g=c.subarray(3*f,3*f+3),y=u.subarray(2*f,2*f+2);f=l[d+2];const M=c.subarray(3*f,3*f+3),_=u.subarray(2*f,2*f+2),v=i.subVec3(g,p,t),A=i.subVec3(M,p,e),w=i.subVec2(y,m,n),b=i.subVec2(_,m,r),E=1/(w[0]*b[1]-w[1]*b[0]),S=i.mulVec3Scalar(i.subVec3(i.mulVec3Scalar(v,b[1],o),i.mulVec3Scalar(A,w[1],s),a),E,s);let T;for(let t=0;t<3;t++)T=3*l[d+t],h[T]+=S[0],h[T+1]+=S[1],h[T+2]+=S[2]}return h}})(),buildPickTriangles(t,e,n){const r=e.length,o=n?new Uint16Array(9*r):new Float32Array(9*r),s=new Uint8Array(12*r);let a,i,c,l,u,h,d=0,f=0,p=0;for(let m=0;m<r;m+=3)h=d>>24&255,u=d>>16&255,l=d>>8&255,c=255&d,i=e[m],a=3*i,o[f++]=t[a],o[f++]=t[a+1],o[f++]=t[a+2],s[p++]=c,s[p++]=l,s[p++]=u,s[p++]=h,i=e[m+1],a=3*i,o[f++]=t[a],o[f++]=t[a+1],o[f++]=t[a+2],s[p++]=c,s[p++]=l,s[p++]=u,s[p++]=h,i=e[m+2],a=3*i,o[f++]=t[a],o[f++]=t[a+1],o[f++]=t[a+2],s[p++]=c,s[p++]=l,s[p++]=u,s[p++]=h,d++;return{positions:o,colors:s}},faceToVertexNormals(t,e,n={}){const r=n.smoothNormalsAngleThreshold||20,o={},s=[],a={};let c,l,u,h,d;const f=1e4;let p,m,g,y,M,_;for(m=0,y=t.length;m<y;m+=3){p=m/3,l=t[m],u=t[m+1],h=t[m+2],d=`${Math.round(l*f)}_${Math.round(u*f)}_${Math.round(h*f)}`,void 0===o[d]?o[d]=[p]:o[d].push(p);const n=i.normalizeVec3([e[m],e[m+1],e[m+2]]);s[p]=n,c=i.vec4([n[0],n[1],n[2],1]),a[p]=c}for(d in o)if(o.hasOwnProperty(d)){const t=o[d],e=t.length;for(m=0;m<e;m++){const n=t[m];for(c=a[n],g=0;g<e;g++){if(m===g)continue;const e=t[g];M=s[n],_=s[e];Math.abs(i.angleVec3(M,_)/i.DEGTORAD)<r&&(c[0]+=_[0],c[1]+=_[1],c[2]+=_[2],c[3]+=1)}}}for(m=0,y=e.length;m<y;m+=3)c=a[m/3],e[m+0]=c[0]/c[3],e[m+1]=c[1]/c[3],e[m+2]=c[2]/c[3]},canvasPosToWorldRay:(()=>{const t=new Float32Array(16),e=new Float32Array(16),n=new Float32Array(4),r=new Float32Array(4),o=new Float32Array(4),s=new Float32Array(4);return(a,c,l,u,h,d)=>{const f=i.mulMat4(l,c,t),p=i.inverseMat4(f,e),m=a.width,g=a.height,y=(u[0]-m/2)/(m/2),M=-(u[1]-g/2)/(g/2);n[0]=y,n[1]=M,n[2]=-1,n[3]=1,i.transformVec4(p,n,r),i.mulVec4Scalar(r,1/r[3]),o[0]=y,o[1]=M,o[2]=1,o[3]=1,i.transformVec4(p,o,s),i.mulVec4Scalar(s,1/s[3]),h[0]=s[0],h[1]=s[1],h[2]=s[2],i.subVec3(s,r,d),i.normalizeVec3(d)}})(),canvasPosToLocalRay:(()=>{const t=new Float32Array(3),e=new Float32Array(3);return(n,r,o,s,a,c,l)=>{i.canvasPosToWorldRay(n,r,o,a,t,e),i.worldRayToLocalRay(s,t,e,c,l)}})(),worldRayToLocalRay:(()=>{const t=new Float32Array(16),e=new Float32Array(4),n=new Float32Array(4);return(r,o,s,a,c)=>{const l=i.inverseMat4(r,t);e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=1,i.transformVec4(l,e,n),a[0]=n[0],a[1]=n[1],a[2]=n[2],i.transformVec3(l,s,c)}})(),buildKDTree:(()=>{const t=new Float32Array;function e(n,r,o,s){const a=new Float32Array(6),i={triangles:null,left:null,right:null,leaf:!1,splitDim:0,aabb:a};let c,l;for(a[0]=a[1]=a[2]=Number.POSITIVE_INFINITY,a[3]=a[4]=a[5]=Number.NEGATIVE_INFINITY,c=0,l=n.length;c<l;++c){var u=3*n[c];for(let t=0;t<3;++t){const e=3*r[u+t];o[e]<a[0]&&(a[0]=o[e]),o[e]>a[3]&&(a[3]=o[e]),o[e+1]<a[1]&&(a[1]=o[e+1]),o[e+1]>a[4]&&(a[4]=o[e+1]),o[e+2]<a[2]&&(a[2]=o[e+2]),o[e+2]>a[5]&&(a[5]=o[e+2])}}if(n.length<20||s>10)return i.triangles=n,i.leaf=!0,i;t[0]=a[3]-a[0],t[1]=a[4]-a[1],t[2]=a[5]-a[2];let h=0;t[1]>t[h]&&(h=1),t[2]>t[h]&&(h=2),i.splitDim=h;const d=(a[h]+a[h+3])/2,f=new Array(n.length);let p=0;const m=new Array(n.length);let g=0;for(c=0,l=n.length;c<l;++c){const t=r[u=3*n[c]],e=3*r[u+1],s=3*r[u+2];o[3*t+h]<=d||o[e+h]<=d||o[s+h]<=d?f[p++]=n[c]:m[g++]=n[c]}return f.length=p,m.length=g,i.left=e(f,r,o,s+1),i.right=e(m,r,o,s+1),i}return(t,n)=>{const r=t.length/3,o=new Array(r);for(let e=0;e<r;++e)o[e]=e;return e(o,t,n,0)}})(),decompressPosition(t,e,n){n[0]=t[0]*e[0]+e[12],n[1]=t[1]*e[5]+e[13],n[2]=t[2]*e[10]+e[14]},decompressPositions(t,e,n=new Float32Array(t.length)){for(let r=0,o=t.length;r<o;r+=3)n[r+0]=t[r+0]*e[0]+e[12],n[r+1]=t[r+1]*e[5]+e[13],n[r+2]=t[r+2]*e[10]+e[14];return n},decompressUV(t,e,n){n[0]=t[0]*e[0]+e[6],n[1]=t[1]*e[4]+e[7]},decompressUVs(t,e,n=new Float32Array(t.length)){for(let r=0,o=t.length;r<o;r+=3)n[r+0]=t[r+0]*e[0]+e[6],n[r+1]=t[r+1]*e[4]+e[7];return n},octDecodeVec2(t,e){let n=t[0],r=t[1];n=(2*n+1)/255,r=(2*r+1)/255;const o=1-Math.abs(n)-Math.abs(r);o<0&&(n=(1-Math.abs(r))*(n>=0?1:-1),r=(1-Math.abs(n))*(r>=0?1:-1));const s=Math.sqrt(n*n+r*r+o*o);return e[0]=n/s,e[1]=r/s,e[2]=o/s,e},octDecodeVec2s(t,e){for(let n=0,r=0,o=t.length;n<o;n+=2){let o=t[n+0],s=t[n+1];o=(2*o+1)/255,s=(2*s+1)/255;const a=1-Math.abs(o)-Math.abs(s);a<0&&(o=(1-Math.abs(s))*(o>=0?1:-1),s=(1-Math.abs(o))*(s>=0?1:-1));const i=Math.sqrt(o*o+s*s+a*a);e[r+0]=o/i,e[r+1]=s/i,e[r+2]=a/i,r+=3}return e}};i.buildEdgeIndices=function(){const t=[],e=[],n=[],r=[],o=[];let s=0;const a=new Uint16Array(3),c=new Uint16Array(3),l=new Uint16Array(3),u=i.vec3(),h=i.vec3(),d=i.vec3(),f=i.vec3(),p=i.vec3(),m=i.vec3(),g=i.vec3();return function(y,M,_,v){!function(o,s){const a={};let i,c,l,u;const h=Math.pow(10,4);let d,f,p=0;for(d=0,f=o.length;d<f;d+=3)i=o[d],c=o[d+1],l=o[d+2],u=Math.round(i*h)+"_"+Math.round(c*h)+"_"+Math.round(l*h),void 0===a[u]&&(a[u]=p/3,t[p++]=i,t[p++]=c,t[p++]=l),e[d/3]=a[u];for(d=0,f=s.length;d<f;d++)r[d]=e[s[d]],n[r[d]]=s[d]}(y,M),function(e,n){s=0;for(let y=0,M=e;y<M;y+=3){const e=3*r[y],M=3*r[y+1],_=3*r[y+2];n?(a[0]=t[e],a[1]=t[e+1],a[2]=t[e+2],c[0]=t[M],c[1]=t[M+1],c[2]=t[M+2],l[0]=t[_],l[1]=t[_+1],l[2]=t[_+2],i.decompressPosition(a,n,u),i.decompressPosition(c,n,h),i.decompressPosition(l,n,d)):(u[0]=t[e],u[1]=t[e+1],u[2]=t[e+2],h[0]=t[M],h[1]=t[M+1],h[2]=t[M+2],d[0]=t[_],d[1]=t[_+1],d[2]=t[_+2]),i.subVec3(d,h,f),i.subVec3(u,h,p),i.cross3Vec3(f,p,m),i.normalizeVec3(m,g);const v=o[s]||(o[s]={normal:i.vec3()});v.normal[0]=g[0],v.normal[1]=g[1],v.normal[2]=g[2],s++}}(M.length,_);const A=[],w=Math.cos(i.DEGTORAD*v),b={};let E,S,T,V,O,B,I,N,F,x,L,P=!1;for(let t=0,e=M.length;t<e;t+=3){const e=t/3;for(let n=0;n<3;n++)E=r[t+n],S=r[t+(n+1)%3],T=Math.min(E,S),V=Math.max(E,S),O=T+","+V,void 0===b[O]?b[O]={index1:T,index2:V,face1:e,face2:void 0}:b[O].face2=e}for(O in b)B=b[O],void 0!==B.face2&&(I=o[B.face1].normal,N=o[B.face2].normal,F=i.dotVec3(I,N),F>w)||(x=n[B.index1],L=n[B.index2],(!P&&x>65535||L>65535)&&(P=!0),A.push(x),A.push(L));return P?new Uint32Array(A):new Uint16Array(A)}}()},zcj1:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=[["0",10],["A",26],["a",26],["_",1],["$",1]].map((function(t){for(var e=[],n=t[0].charCodeAt(0),r=n+t[1],o=n;o<r;++o)e.push(o);return String.fromCharCode.apply(null,e)})).join("");function o(t,e){return(e&&4!==e?[0,6]:[0,6,12,18]).map((function(e){return r.substr(parseInt(t/(1<<e))%64,1)})).reverse().join("")}const s={xmlToJson:function t(e,n){if(e.nodeType===e.TEXT_NODE){var r=e.nodeValue;if(null===r.match(/^\s+$/))return r}else if(e.nodeType===e.ELEMENT_NODE||e.nodeType===e.DOCUMENT_NODE){var o={type:e.nodeName,children:[]};if(e.nodeType===e.ELEMENT_NODE)for(var s=0;s<e.attributes.length;s++){var a=e.attributes[s];o[n[a.nodeName]||a.nodeName]=a.nodeValue}for(var i=0;i<e.childNodes.length;i++){(s=t(e.childNodes[i],n))&&o.children.push(s)}return o}},clone:function(t){return JSON.parse(JSON.stringify(t))},compressGuid:function(t){var e=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30].map((function(e){return parseInt(t.substr(e,2),16)}));return o(e[0],2)+[1,4,7,10,13].map((function(t){return o((e[t]<<16)+(e[t+1]<<8)+e[t+2])})).join("")},findNodeOfType:function(t,e){var n=[],r=function(t){t.type===e&&n.push(t),(t.children||[]).forEach((function(t){r(t)}))};return r(t),n},timeout:function(t){return new Promise((function(e,n){setTimeout(e,t)}))},httpRequest:function(t){return new Promise((function(e,n){var r=new XMLHttpRequest;r.open(t.method||"GET",t.url,!0),r.onload=function(o){console.log(t.url,r.readyState,r.status),4===r.readyState&&(200===r.status?e(r.responseXML):n(r.statusText))},r.send(null)}))},loadJSON:function(t,e,n){var r=t=>{};e=e||r,n=n||r;var o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",t,!0),o.addEventListener("load",(function(t){var r=t.target.response;if(200===this.status){var o;try{o=JSON.parse(r)}catch(s){n(`utils.loadJSON(): Failed to parse JSON response - ${s}`)}e(o)}else if(0===this.status){console.warn("loadFile: HTTP Status 0 received.");try{e(JSON.parse(r))}catch(s){n(`utils.loadJSON(): Failed to parse JSON response - ${s}`)}}else n(t)}),!1),o.addEventListener("error",(function(t){n(t)}),!1),o.send(null)},loadArraybuffer:function(t,e,n){var r=t=>{};e=e||r,n=n||r;const o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){const t=!!o[2];var s=o[3];s=window.decodeURIComponent(s),t&&(s=window.atob(s));try{const t=new ArrayBuffer(s.length),n=new Uint8Array(t);for(var a=0;a<s.length;a++)n[a]=s.charCodeAt(a);window.setTimeout((function(){e(t)}),0)}catch(i){window.setTimeout((function(){n(i)}),0)}}else{const r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?e(r.response):n("loadArrayBuffer error : "+r.response))},r.send(null)}},queryString:function(){for(var t={},e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var r=e[n].split("=");if("undefined"===typeof t[r[0]])t[r[0]]=decodeURIComponent(r[1]);else if("string"===typeof t[r[0]]){var o=[t[r[0]],decodeURIComponent(r[1])];t[r[0]]=o}else t[r[0]].push(decodeURIComponent(r[1]))}return t}(),isArray:function(t){return t&&!t.propertyIsEnumerable("length")&&"object"===typeof t&&"number"===typeof t.length},isString:function(t){return"string"===typeof t||t instanceof String},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isID:function(t){return s.isString(t)||s.isNumeric(t)},isSameComponent:function(t,e){return!(!t||!e)&&(s.isNumeric(t)||s.isString(t)?`${t}`:t.id)===(s.isNumeric(e)||s.isString(e)?`${e}`:e.id)},isFunction:function(t){return"function"===typeof t},isObject:function(t){const e={}.constructor;return!!t&&t.constructor===e},copy:function(t){return s.apply(t,{})},apply:function(t,e){for(const n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},apply2:function(t,e){for(const n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&null!==t[n]&&(e[n]=t[n]);return e},applyIf:function(t,e){for(const n in t)t.hasOwnProperty(n)&&(void 0!==e[n]&&null!==e[n]||(e[n]=t[n]));return e},isEmptyObject:function(t){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0},inQuotes:function(t){return s.isNumeric(t)?`${t}`:`'${t}'`},concat:function(t,e){const n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n},flattenParentChildHierarchy:function(t){var e=[];return function t(n){n.id=n.uuid,delete n.oid,e.push(n);var r=n.children;if(r)for(var o=0,s=r.length;o<s;o++){r[o].parent=n.id,t(r[o])}n.children=[]}(t),e}}}}]);